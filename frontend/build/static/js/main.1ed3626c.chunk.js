(this["webpackJsonpmimic-recording-studio"]=this["webpackJsonpmimic-recording-studio"]||[]).push([[0],{14:function(e,t,a){e.exports=a.p+"static/media/space.aac7a8f2.svg"},15:function(e,t,a){e.exports=a.p+"static/media/P.38bc67ef.svg"},16:function(e,t,a){e.exports=a.p+"static/media/right.35ec7893.svg"},21:function(e,t,a){},24:function(e,t,a){e.exports=a.p+"static/media/logo.c1867f96.svg"},28:function(e,t,a){e.exports=a(40)},33:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(23),i=a.n(o),s=(a(33),a(2)),c=a(3),l=a(5),u=a(4),d=(a(21),a(12)),m=a(24),p=a.n(m),h=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"topnav"},r.a.createElement(d.b,{to:"/"},r.a.createElement("img",{className:"logo",src:p.a,height:"24px",alt:""})))}}]),a}(n.Component),f=window.localStorage;var v=function(){return f.getItem("name")},b=function(){f.setItem("uuid",function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}())},y=function(){return f.getItem("uuid")},g=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).renderInput=function(){return r.a.createElement("div",null,r.a.createElement("p",null,"To get started, enter your name and hit the Record button."),r.a.createElement("input",{type:"text",id:"yourname",placeholder:"Your Name",onChange:n.handleInput}))},n.renderWelcomeBackMsg=function(){return r.a.createElement("div",null,r.a.createElement("p",null,"Welcome back ",n.state.name,"!"),r.a.createElement("p",null,"Hit Train Mimic to continue recording"))},n.handleInput=function(e){n.setState({name:e.target.value})},n.handleTrainMimicBtn=function(){var e;void 0===n.state.name?alert("Please input a name before proceeding!"):(e=n.state.name,f.setItem("name",e),n.props.history.push("/record"))},n.state={name:void 0},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=v();e&&this.setState({name:e})}},{key:"render",value:function(){return r.a.createElement("div",{className:"page-intro"},r.a.createElement("div",{id:"PageIntro"},r.a.createElement("h2",{style:{color:"#FD9E66"}},"Mimic Recording Studio"),r.a.createElement("h1",null,"Help us build the voice(s) of Mycroft!"),r.a.createElement("p",null,"Mycroft's open source Mimic technologies are Text-to-Speech engines, which take a piece of written text and convert it into spoken audio. The latest generation of this technology uses machine learning techniques to create a model, which can speak a specific language, sounding like the voice on which it was trained."),r.a.createElement("p",null,"The Mimic Recording Studio simplifies the collection of training data from individuals, each of which can be used to produce a distinct voice for Mimic."),r.a.createElement("div",{className:"instructions"},r.a.createElement("i",{className:"fas fa-book-open"}),r.a.createElement("h2",null,"guide"),r.a.createElement("p",null,"Mimic II preserves the rhythm, tone and pronunciation from source recordings. As a result, it is important for all recordings to use a consistent voice for the personality of the final product."),r.a.createElement("p",null,"To help with this, adopt the assistant persona for all recordings:"),r.a.createElement("ul",{className:"persona-desc"},r.a.createElement("li",null,r.a.createElement("span",{className:"li-title"},"The assistant is knowledgeable and confident, yet humble."),r.a.createElement("br",null)," The assistant has access to all the world's information, but is aware of his or her own limitations, and doesn't mind being corrected."),r.a.createElement("li",null,r.a.createElement("span",{className:"li-title"},"The assistant loves knowledge and enjoys sharing information with others."),r.a.createElement("br",null)," This enjoyment can be clearly heard in the energy and enthusiasm in his or her voice."),r.a.createElement("li",null,r.a.createElement("span",{className:"li-title"},"The assistant is persistent, optimistic and upbeat."),r.a.createElement("br",null)," Even if there are errors or misunderstandings, the tone should be positive, without any sign of frustration."),r.a.createElement("li",null,r.a.createElement("span",{className:"li-title"},"The assistant is professional without being stiff or overly formal."),r.a.createElement("br",null)," The assistant speaks with an efficient, yet unrushed pace, similar to what you might hear from a news anchor."))),v()?this.renderWelcomeBackMsg():this.renderInput(),r.a.createElement("div",{className:"btn_PageIntro"},r.a.createElement("button",{id:"btn_PageIntro",className:"btn",onClick:this.handleTrainMimicBtn},"Record"))))}}]),a}(n.Component),E=a(13),w=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"start",value:function(){this.mediaRecorder.start()}},{key:"stop",value:function(){this.mediaRecorder.stop()}},{key:"pause",value:function(){this.mediaRecorder.pause()}},{key:"resume",value:function(){this.mediaRecorder.resume()}},{key:"componentDidMount",value:function(){var e=this;if(navigator.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.webkitGetUserMedia,navigator.getUserMedia&&window.MediaRecorder){this.chunks=[];var t=this.props,a=t.blobOpts,n=t.onStop,r=t.onError,o=t.mediaOpts,i=t.onPause,s=t.onResume,c=t.onStart,l=t.gotStream,u=function(e){console.warn(e),r&&r(e)};navigator.getUserMedia({audio:!0},(function(t){e.mediaRecorder=new window.MediaRecorder(t,o||{}),e.mediaRecorder.ondataavailable=function(t){e.chunks.push(t.data)},e.mediaRecorder.onstop=function(t){var r=new window.Blob(e.chunks,a||{type:"audio/wav"});e.chunks=[],n(r)},e.mediaRecorder.onerror=u,i&&(e.mediaRecorder.onpause=i),s&&(e.mediaRecorder.onresume=s),c&&(e.mediaRecorder.onstart=c),e.stream=t,l&&l(t)}),u)}else{console.warn("Audio recording APIs not supported by this browser");var d=this.props.onMissingAPIs;d?d(navigator.getUserMedia,window.MediaRecorder):window.alert("Your browser doesn't support native microphone recording. For best results, we recommend using Google Chrome or Mozilla Firefox to use this site.")}}},{key:"componentDidUpdate",value:function(e){this.props.command&&"none"!==this.props.command&&e.command!==this.props.command&&this[this.props.command]()}},{key:"componentWillUnmount",value:function(){this.props.onUnmount&&this.props.onUnmount(this.stream)}},{key:"render",value:function(){return!1}}]),a}(r.a.Component),k=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).renderFeedback=function(){if(e.props.promptNum<20||0===e.props.audioLen)return"";var t=e.props.prompt.length/e.props.audioLen,a=(e.props.totalCharLen/e.props.totalTime).toFixed(1);return e.determinePace(a,t)?r.a.createElement("div",{className:"feedback-ball-green"},"Consistent Pace"):t<a?r.a.createElement("div",{className:"feedback-ball-red"},"Slower than your average"):r.a.createElement("div",{className:"feedback-ball-red"},"Faster than your average")},e.determinePace=function(t,a){return e.props.prompt.length<=25?.5*t<a&&a<1.5*t:e.props.prompt.length<=125?.75*t<a&&a<1.25*t:.85*t<a&&a<1.15*t},e}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{id:"phraseBox"},r.a.createElement("div",{id:"phrase"},this.renderFeedback(),this.props.prompt))}}]),a}(n.Component),N=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).secondsToHms=function(e){e=Number(e);var t=Math.floor(e/3600),a=Math.floor(e%3600/60),n=Math.floor(e%3600%60);return(t>0?t+(1===t?" hour, ":" hours, "):"")+(a>0?a+(1===a?" minute, ":" minutes, "):"")+(n>0?n+(1===n?" second":" seconds"):"")},e}return Object(c.a)(a,[{key:"render",value:function(){var e=(this.props.totalCharLen/this.props.totalTime).toFixed(1);return e=isNaN(e)?0:e,r.a.createElement("div",{className:"metrics-container"},r.a.createElement("div",{className:"total-hours"},r.a.createElement("h2",null,"PROGRESS"),r.a.createElement("div",null,"Phrase: ",this.props.promptNum," / ",this.props.totalPrompt),r.a.createElement("div",null,"Time Recorded: ",this.secondsToHms(Math.round(this.props.totalTime)))),r.a.createElement("div",{className:"speech-rate"},r.a.createElement("h2",null,"SPEECH RATE"),r.a.createElement("div",null,"Overall Average: ",e," characters per second")))}}]),a}(n.Component),T=a(26),C=a.n(T),R=a(27),O=a.n(R),j=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleKeyDown=function(t){27===t.keyCode&&e.wavesurfer.pause()},e.loadWaveForm=function(t){e.wavesurfer.loadBlob(t)},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keydown",this.handleKeyDown,!1);var t=this.props,a=t.waveColor,n=t.blob;this.wavesurfer=O.a.create({container:"#waveform",waveColor:a||"#FD9E66"}),this.loadWaveForm(n),this.wavesurfer.on("finish",(function(){e.wavesurfer.pause(),e.props.onFinish()}))}},{key:"componentDidUpdate",value:function(){this.props.play?(console.log("play"),this.wavesurfer.play()):(console.log("pausing"),this.wavesurfer.pause())}},{key:"render",value:function(){var e=this.props.className?this.props.className:"";return r.a.createElement("div",{id:"waveform",className:e})}}]),a}(n.Component),S=a(14),M=a.n(S),P=a(15),x=a.n(P),D=a(16),W=a.n(D),L="http://localhost:5000/",I=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).dismissPopup=function(){n.setState({showPopup:!1})},n.requestPrompts=function(e){(function(e){return fetch(L+"api/prompt/?uuid=".concat(e),{method:"GET"})})(e).then((function(e){return e.json()})).then((function(e){e.success&&n.setState({prompt:e.data.prompt,totalPrompt:e.data.total_prompt})}))},n.requestUserDetails=function(e){(function(e){return fetch(L+"api/user/?uuid=".concat(e),{method:"GET"})})(e).then((function(e){return e.json()})).then((function(e){e.success?(n.setState({userName:e.data.user_name,language:e.data.language,promptNum:e.data.prompt_num,totalTime:e.data.total_time_spoken,totalCharLen:e.data.len_char_spoken}),n.requestPrompts(n.uuid)):n.uuid?function(e,t){var a={uuid:e,user_name:t};return fetch(L+"api/user/",{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json"}})}(n.uuid,n.name).then((function(e){return e.json()})).then((function(e){e.success?(n.setState({userCreated:!0}),n.requestPrompts(n.uuid)):alert("sorry there is in error creating user")})):alert("sorry there is in error creating user")}))},n.renderWave=function(){return r.a.createElement(j,{className:"wavedisplay",waveColor:"#FD9E66",blob:n.state.blob,play:n.state.play,onFinish:n.stopWav})},n.renderVisualizer=function(){return r.a.createElement(E.ReactMic,{className:"wavedisplay",record:n.state.shouldRecord,backgroundColor:"#222222",strokeColor:"#FD9E66"})},n.processBlob=function(e){var t,a;(t=n.uuid,a=e,fetch(L+"api/audio/?uuid=".concat(t,"&get_len=True"),{method:"POST",body:a,headers:{"Content-Type":"audio/wav"}})).then((function(e){return e.json()})).then((function(e){return void 0===e.data?n.setState({shouldRecord:!1,displayWav:!1,blob:void 0,promptNum:0,totalTime:0,totalCharLen:0,audioLen:0,play:!1}):n.setState({audioLen:e.data.audio_len})})),n.setState({blob:e}),n.shoulddisplayWav(!0)},n.shoulddisplayWav=function(e){return n.setState({displayWav:e})},n.playWav=function(){return n.setState({play:!0})},n.stopWav=function(){return n.setState({play:!1})},n.handleKeyDown=function(e){32===e.keyCode&&(n.state.shouldRecord||(e.preventDefault(),n.reset(),n.recordHandler())),27===e.keyCode&&(e.preventDefault(),n.reset()),82===e.keyCode&&n.playWav(),39===e.keyCode&&(n.state.play||n.onNext())},n.reset=function(){n.setState({shouldRecord:!1,displayWav:!1,blob:void 0,audioLen:0,play:!1})},n.recordHandler=function(){setTimeout((function(){n.setState((function(e,t){return{shouldRecord:!0,play:!1}}))}),500)},n.onNext=function(){var e,t,a;void 0!==n.state.blob&&(e=n.state.blob,t=n.state.prompt,a=n.uuid,fetch(L+"api/audio/?uuid=".concat(a,"&prompt=").concat(t),{method:"POST",body:e,headers:{"Content-Type":"audio/wav"}})).then((function(e){return e.json()})).then((function(e){e.success?(n.setState({displayWav:!1}),n.requestPrompts(n.uuid),n.requestUserDetails(n.uuid),n.setState({blob:void 0,audioLen:0})):alert("There was an error in saving that audio")})).catch((function(e){return console.log(e)}))},n.silenceDetection=function(e){C()(e,{interval:"150",threshold:-80}).on("stopped_speaking",(function(){n.setState({shouldRecord:!1})}))},n.state={userCreated:!1,shouldRecord:!1,displayWav:!1,blob:void 0,play:!1,prompt:"*error loading prompt... is the backend running?*",language:"",promptNum:0,totalTime:0,totalCharLen:0,audioLen:0,showPopup:!1},n.uuid=y(),n.name=v(),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown,!1),this.requestUserDetails(this.uuid)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown,!1)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"PageRecord"},r.a.createElement("h1",null,"Mimic Recording Studio"),r.a.createElement(F,{userName:this.name,route:this.props.history.push,show:this.state.showPopup,dismiss:this.dismissPopup}),r.a.createElement(N,{totalTime:this.state.totalTime,totalCharLen:this.state.totalCharLen,promptNum:this.state.promptNum,totalPrompt:this.state.totalPrompt}),r.a.createElement(k,{prompt:this.state.prompt,promptNum:this.state.promptNum,audioLen:this.state.audioLen,totalCharLen:this.state.totalCharLen,totalTime:this.state.totalTime}),r.a.createElement("div",{className:"wave-container",id:"container"},this.state.displayWav?this.renderWave():this.renderVisualizer(),r.a.createElement(w,{command:this.state.shouldRecord?"start":"stop",onStart:function(){return e.shoulddisplayWav(!1)},onStop:this.processBlob,gotStream:this.silenceDetection})),r.a.createElement("div",{className:"indicator-container"},this.state.shouldRecord?"Read Now [Esc] to cancel":"[Spacebar] to Start Recording [R] to review [->] for next"),r.a.createElement("div",{id:"controls"},r.a.createElement("button",{id:"btn_Play",className:"btn btn-play ".concat(this.state.shouldRecord||void 0===this.state.blob||this.state.play?"btn-disabled":null," "),onClick:this.state.shouldRecord||this.state.play?function(){return null}:this.playWav},r.a.createElement("i",{className:"fas fa-play ibutton"}),"Review"),r.a.createElement("button",{id:"btn_Next",className:"btn-next ".concat(this.state.shouldRecord||void 0===this.state.blob||this.state.play?"btn-disabled":null),onClick:this.state.shouldRecord||this.state.play?function(){return null}:this.onNext},r.a.createElement("i",{className:"fas fa-forward ibutton-next"}),"Next")))}}]),a}(n.Component),F=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).renderContainer=function(){return r.a.createElement("div",{className:"top-container"},r.a.createElement("div",{className:"top-container-info"},r.a.createElement("div",{className:"instructions2"},r.a.createElement("i",{className:"fas fa-info-circle"}),r.a.createElement("h2",null,"HINTS"),r.a.createElement("ul",{className:"hints"},r.a.createElement("li",null,r.a.createElement("img",{src:M.a,className:"key-icon",alt:"space"})," will start recording"),r.a.createElement("li",null,"Recording will auto-stop after you speak"),r.a.createElement("li",null,r.a.createElement("img",{src:x.a,className:"key-icon",alt:"p"})," will play recorded audio"),r.a.createElement("li",null,r.a.createElement("img",{src:W.a,className:"key-icon",alt:"->"})," will go to next prompt"))),r.a.createElement("div",{className:"session-info"},r.a.createElement("div",{className:"top-info"},r.a.createElement("div",null,r.a.createElement("h2",null,"RECORDER"),"\xa0",r.a.createElement("span",{id:"sessionName"},e.props.userName)),r.a.createElement("div",{className:"btn-restart"})),r.a.createElement("hr",null),r.a.createElement("p",null,"It is very important that the recorded words"," ",r.a.createElement("span",{className:"highlight"},"match the text in the script exactly"),". If you accidentally deviate from the script or are unsure, please record the prompt again."))),r.a.createElement("button",{className:"btn info-btn",onClick:e.handleClick},"Tutorial"),r.a.createElement("button",{className:"btn info-btn",onClick:e.props.dismiss},"Continue"))},e.handleClick=function(){e.props.route("/tutorial")},e}return Object(c.a)(a,[{key:"render",value:function(){return this.props.show?this.renderContainer():null}}]),a}(n.Component),U=I,_=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(){e.props.history.push("/record")},e}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("h1",null,"Tutorial"),r.a.createElement("div",{className:"tutorial"},"The Mimic Recording Studio was made to simplify the process of creating your own text to speech corpus. This tutorial will help you get started.",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("h2",null,"Recording Box"),r.a.createElement(k,{prompt:"The human voice is the most perfect instrument of all.",promptNum:0,audioLen:0,totalCharLen:0,totalTime:0}),r.a.createElement(E.ReactMic,{className:"wavedisplay",record:!1,backgroundColor:"#222222",strokeColor:"#FD9E66"}),r.a.createElement("p",null,"In the middle, you can see the phrase to record. To start the recording press the \xa0",r.a.createElement("img",{src:M.a,className:"key-icon",alt:"space"})," \xa0 bar. The recording should automatically stop when it detects silence. To replay the recording press the \xa0",r.a.createElement("img",{src:x.a,className:"key-icon",alt:"p"})," \xa0 key. You may re-record that same phrase as many times as you like. ",r.a.createElement("b",null,"It is essential that the recorded words match the text in the script exactly. ")," If you accidentally deviate from the script or are unsure, please record the prompt again. Once saved you may not be able to go back. Press the \xa0",r.a.createElement("img",{src:W.a,className:"key-icon",alt:"->"}),"\xa0 key to keep the recording and move on to the next phrase.")),r.a.createElement("div",null,r.a.createElement("h2",null,"Feedback"),r.a.createElement("p",null,"When recording stops, you may notice a feedback indicator appearing in the top right corner of the Recording Box. This indicator will tell you if you are speaking to fast, to slow, or at a good pace."),r.a.createElement("div",{className:"grid-layout"},r.a.createElement("div",{className:"feedback-ball-green-t"},"Good Pace"),r.a.createElement("div",{className:"feedback-ball-red-t"},"Too Slow"),r.a.createElement("div",{className:"feedback-ball-red-t"},"Too Fast")),r.a.createElement("p",null,r.a.createElement("b",null,"The indicator is determined using your average speech rate. The indicator will only start appearing after 100 recorded samples."))),r.a.createElement("div",null,r.a.createElement("button",{className:"btn",onClick:this.handleClick},"Record"))))}}]),a}(n.Component),A=a(1),B=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){y()||b()}},{key:"render",value:function(){return r.a.createElement(d.a,{onUpdate:function(){return window.scrollTo(0,0)}},r.a.createElement("div",{className:"App"},r.a.createElement(h,null),r.a.createElement("div",{className:"page"},r.a.createElement(A.a,{exact:!0,path:"/",component:g}),r.a.createElement(A.a,{path:"/record",component:U}),r.a.createElement(A.a,{path:"/tutorial",component:_}))))}}]),a}(n.Component);i.a.render(r.a.createElement(B,null),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.1ed3626c.chunk.js.map